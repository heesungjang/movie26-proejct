<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../static/css/reset.css" />
        <link rel="stylesheet" href="../static/css/style.css" />
        <link rel="stylesheet" href="../static/css/detail.css" />
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script
            type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"
        ></script>
        <script
            type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"
        ></script>
        <title>Document</title>
    </head>
    <body>
        <script type="text/javascript" src="/static/js/main.js"></script>
        <section class="detail-container">
            <div class="detail__left">
                <iframe id="movie-trailer"
                    src='https://www.youtube.com/embed/{{movie["video"]}}'
                    title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                ></iframe>
                <!-- <img src="../static/img/logo4.png" alt="영화이름" /> -->
            </div>
            <div class="detail__right">
                <div class="detail__titles">
                    <div class="titles__title">
                        <h3>{{movie["title"]}}</h3>
                        <p>예매율: {{movie["booking"]}}</p>
                    </div>
                    <a href="#"
                        ><svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-5 w-5"
                            viewBox="0 0 20 20"
                            fill="currentColor"
                        >
                            <path
                                fill-rule="evenodd"
                                d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"
                                clip-rule="evenodd"
                            /></svg
                    ></a>
                </div>

                <div class="detail__contents">
                    <ul class="contents__left">
                        <li>개봉 <span>{{movie["date"]}}</span></li>
                        <li>장르 <span>{{movie["genre"]}}</span></li>
                    </ul>
                    <ul class="contents__right">
                        <li>
                            평점
                            <span>
                                <svg
                                    aria-hidden="true"
                                    focusable="false"
                                    data-prefix="fas"
                                    data-icon="star"
                                    class="svg-inline--fa fa-star fa-w-18"
                                    role="img"
                                    xmlns="http://www.w3.org/2000/svg"
                                    viewBox="0 0 576 512"
                                >
                                    <path
                                        fill="currentColor"
                                        d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"
                                    ></path>
                                </svg>
                                {{movie["rate"]}}</span
                            >
                        </li>
                        <li>등급 <span>15세이상관람가</span></li>
                        <li>감독 <span>{{movie["producer"]}}</span></li>
                    </ul>
                </div>
                <div class="detail__review">
                    <div class="review__title">
                        <h3>영화는 어땠나요?</h3>
                        <button id="jsReviewBtn">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="h-6 w-6"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M19 9l-7 7-7-7"
                                />
                            </svg>
                        </button>
                    </div>
                    <div id="jsReview" class="hide">
                        <textarea
                            id="input-comment"
                            placeholder="리뷰를 적어주세요!"
                        ></textarea>
                        <input
                            id="jsReviewSubmit"
                            class="reviewBtn"
                            type="submit"
                            value="작성완료!"
                        />
                    </div>
                    {% if reviews %}
                    <ul class="reviews">
                        {% for review in reviews%}
                        <div class="review">
                            <li>
                                <span class="review-text"
                                    >{{review["comment"]}}</span
                                >
                                <span>{{review["user_id"]}}</span>
                            </li>
                            <button class="jsReviewDelete">
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="h-6 w-6"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                    stroke="currentColor"
                                >
                                    <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="2"
                                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                                    />
                                </svg>
                            </button>
                        </div>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
            </div>
        </section>
        <script>
            const REVIEW_BTN = document.getElementById("jsReviewBtn");
            const BTN_ICON = REVIEW_BTN.querySelector("svg");
            const REVIEW = document.getElementById("jsReview");
            const REVIEW_SUBMIT = document.getElementById("jsReviewSubmit");
            const REVIEW_DELETE =
                document.getElementsByClassName("jsReviewDelete");

            function onClickReviewBtn() {
                REVIEW.classList.toggle("show");
                if (REVIEW.classList[1] === "show")
                    BTN_ICON.style.transform = "rotate(180deg)";
                else BTN_ICON.style.transform = "rotate(0deg)";
            }

            if (REVIEW_BTN)
                REVIEW_BTN.addEventListener("click", onClickReviewBtn);
            if (REVIEW_SUBMIT)
                REVIEW_SUBMIT.addEventListener("click", create_comment);
            if (REVIEW_DELETE)
                Array.from(REVIEW_DELETE).forEach(function (DELETE) {
                    DELETE.addEventListener("click", delete_comment);
                });
        </script>
    </body>
</html>
